---
layout: post
title:  "Creating beautiful Powershell Reports in Excel"
date:   2019-07-31 13:00
comments: true
description: "Creating-beautiful-Powershell-Reports-in-Excel"
categories:
    - PowerShell
tags:
    - PowerShell, Excel, Reports
---

Everyone wants to produce slick looking reports. Want to impress management?

Here's `Get-Process`, `Get-Service` and a `directory listing` all in one report.

![](/images/posts/ImportExcelBeautifulReport.png)

Read on to see how easy it is to do, and the bonus feature at the end.

## The PowerShell Code

To pull this together you need my PowerShell module from the PowerShell Gallery. If you want to view the results, you need Microsoft Excel installed.

```powershell
Install-Module -Name ImportExcel
```

Now you're ready to run the script and get the results.

```powershell
$xlfile = "$env:TEMP\PSreports.xlsx"
rm $xlfile -ErrorAction SilentlyContinue

# Get-Process
Get-Process | Select -First 5 |
    Export-Excel $xlfile -AutoSize -StartRow 2 -TableName ReportProcess

# Get-Service
Get-Service | Select -First 5 |
    Export-Excel $xlfile -AutoSize -StartRow 11 -TableName ReportService

# Directory Listing
$excel = dir C:\Users\Douglas\Documents\WindowsPowerShell |
    Select PSDRive, PSIsC*, FullName, *time* |
    Export-Excel $xlfile -AutoSize -StartRow 20 -TableName ReportFiles -PassThru

# Get the sheet named Sheet1
$ws = $excel.Workbook.Worksheets['Sheet1']

# Create a hashtable with a few properties
# that you'll splat on Set-Format
$xlParams = @{WorkSheet=$ws;Bold=$true;FontSize=18;AutoSize=$true}

# Create the headings in the Excel worksheet
Set-Format -Range A1  -Value "Report Process" @xlParams
Set-Format -Range A10 -Value "Report Service" @xlParams
Set-Format -Range A19 -Value "Report Files"   @xlParams

# Close and Save the changes to the Excel file
# Launch the Excel file using the -Show switch
Close-ExcelPackage $excel -Show
```

## Bonus Feature

Filtering

![](/images/posts/ImportExcelBeautifulReportFilter.png)